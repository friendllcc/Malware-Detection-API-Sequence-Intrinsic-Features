# Malware Detection based on API Sequence Intrinsic Features

## Required packages
- numpy
- scikit-learn
- tensorflow 2.3.1
- keras 2.4.3

## Files
- data.npz (in data.zip): the dataset after data preprocessing
    - train_x_name: API sequences index for training
    - train_x_semantic: semantic chain index for training
    - train_y: label for training
    - test_x_name: API sequences index for test
    - test_x_semantic: semantic chain index for test
    - test_y: label for test
    - train_MD5: training samples' MD5 index
    - test_MD5: test samples' MD5 index
- model.h5 (in model.zip): a trained model for test
- model.py: model architecture and model training
- test.py: model evaluation
- ablation_study.py: mdoel architecture with different structures
- CuckooReport2APISequence: an example Cuckoo report and API sequence extraction
- DictionaryForRawData: some dictionaries used in data preprocessing

## Dataset Overview
We obtain API sequences from a large number of Windows software in 2020.
- Malware dataset which consists of Spyware, Backdoor, Virus, Downloader, Adware, Worm, Trojan, Dropper, and Disputed is collected from VirusShare and Virustotal. 
- Goodware dataset which consists of System, Internet, Games, Bussiness, Media, Software Development Kit, Education, Social, Travel and Tools is collected from system files of a fresh Windows7 64-bit installation and popular free software sources (including Softonic, SourceForge and Portableapps)

We apply Cuckoo Sandbox to record API sequences while running the software samples.
The preprocessed dataset is stored in 'data.npz'. User can get the original API sequences and semantic chains through the dictionaries in DictionartForRawData.

